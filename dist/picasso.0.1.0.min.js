/**
* Picasso
* A Framework to build dinamic forms using MVC
* Build date: 2014-05-12
* @author Rubens Pinheiro Gonçalves Cavalcante
* @version 0.1.0
* @license GPLv3
*/
var Picasso=Picasso||{};Picasso.info={author:"Rubens Pinheiro Gonçalves Cavalcante",version:"0.1.0",build:"2014-05-12",license:"GPLv3"},Picasso.load=function(a){var b=a.split("."),c=Picasso;"Picasso"===b[0]&&(b=b.slice(1));for(var d=0;d<b.length;d++)"undefined"==typeof c[b[d]]&&(c[b[d]]={}),c=c[b[d]];return c},Picasso.load("pjo.Event"),Picasso.pjo.Event=function(a,b,c){this.name=a||"any",this.data=b||null,this.target=c||null},Picasso.load("pjo.EventHandler"),Picasso.pjo.EventHandler=function(a,b,c){this.eventName=a||"",this.callback=b||new Function,this.context=c||null},Picasso.load("error.InvalidParameters"),Picasso.error.InvalidParameters=function(a,b,c){this.msg="The function "+a+" has received invalid parameters",this.errorParameters=b||null,this.context=c||null},Picasso.error.InvalidParameters.prototype=new Error,Picasso.load("Picasso.utils.array"),Picasso.utils.array=function(){var a=Picasso.load("Picasso.utils.object"),b=function(b,c){for(var d=0;d<b.length;d++)if("object"==typeof b[d]&&"object"==typeof c){if(a.equals(b[d],c))return!0}else if(b[d]===c)return!0;return!1},c=function(a,c){if(a.length!=c.length)return!1;for(var d=0;d<c.length;d++)if(!b(a,c[d]))return!1;return!0};return{find:b,equals:c}}(),Picasso.load("Picasso.utils.object"),Picasso.utils.object=function(){var a=function(a,b){var c=new Function;return c.prototype=b.prototype,a.prototype=new c,a._super=b.prototype,a.prototype.constructor=a,a},b=function(a,b){var c;for(c in a)if("undefined"==typeof b[c])return!1;for(c in a)if(a[c])switch(typeof a[c]){case"object":if(!a[c].equals(b[c]))return!1;break;case"function":if("undefined"==typeof b[c]||"equals"!=c&&a[c].toString()!=b[c].toString())return!1;break;default:if(a[c]!=b[c])return!1}else if(b[c])return!1;for(c in b)if("undefined"==typeof a[c])return!1;return!0};return{extend:a,equals:b}}(),Picasso.load("core.Sequence"),Picasso.core.Sequence=function(){var a={},b=function(b){return"undefined"==typeof b||"string"!=typeof b?!1:(a.hasOwnProperty(b)||(a[b]=null),!0)},c=function(a){this._entity=a};return c.prototype.currentVal=function(){return b(this._entity)?a[this._entity]:null},c.prototype.nextVal=function(){return b(this._entity)?null==a[this._entity]?(a[this._entity]=0,0):++a[this._entity]:null},c}(),Picasso.load("core.Subject"),Picasso.core.Subject=function(){var a={},b=function(b,c,d){for(var e=a[c.name]||[],f=0;f<e.length;f++)if("fire"==b){var g=e[f].callback;"string"==typeof g&&e[f].context.hasOwnProperty(g)?e[f].context[g](c):e[f].callback.call(e.context,c)}else e[f].callback!==d||null!=c.context&&e.context!==c.context||e.splice(f,1)};this.subscribe=function(b,c,d){if("undefined"==typeof b)throw new Picasso.error.InvalidParameters("subscribe",{eventType:"obrigatory"},this.subscribe);a.hasOwnProperty(b)||(a[b]=[]);var e=new Picasso.pjo.EventHandler(b,c,d||this);a[b].push(e)},this.unsubscribe=function(c,d,e){if("undefined"==typeof c)throw new Picasso.error.InvalidParameters("usubscribe",{eventType:"obrigatory"},this.unsubscribe);"undefined"==typeof d&&"undefined"==typeof e?delete a[c]:b("unsubscribe",new Picasso.pjo.Event(c,[],e),d)},this.fire=function(a,c,d){if("undefined"==typeof a)throw new Picasso.error.InvalidParameters("fire",{eventType:"obrigatory"},this.fire);b("fire",new Picasso.pjo.Event(a,c,d||this))}},Picasso.load("Controller"),Picasso.Controller=function(){},Picasso.Controller.prototype._UIActions=[],Picasso.Controller.prototype._model=null,Picasso.Controller.prototype._views={},Picasso.Controller.prototype._registerUIAction=function(a){for(var b=this._UIActions.length,c=0;b>c;c++){var d=this._UIActions[c];a.subscribe(d.eventName,d.callback)}},Picasso.Controller.prototype.construct=function(a){this._model=a;var b=arguments.length;if(b>1)for(var c=1;b>c;c++)arguments[c]instanceof Picasso.View&&this.registerView(arguments[c])},Picasso.Controller.prototype.registerView=function(a){a.setModel(this._model),this._views[a._seq]=a,this._registerUIAction(a)},Picasso.Controller.prototype.listen=function(a,b){var c=new Picasso.pjo.EventHandler(a,b,this);this._UIActions.push(c);for(var d in this._views)this._views.hasOwnProperty(d)&&this._views[d].subscribe(a,b)},Picasso.Controller.extend=function(a){return Picasso.utils.object.extend(a,Picasso.Controller)},Picasso.load("Model"),Picasso.Model=function(){},Picasso.Model.prototype=new Picasso.core.Subject,Picasso.Model.prototype.construct=function(){if(!this.hasOwnProperty("_seq")){var a=new Picasso.core.Sequence("Model");this._seq=a.nextVal()}},Picasso.Model.extend=function(a){return Picasso.utils.object.extend(a,Picasso.Model)},Picasso.load("View"),Picasso.View=function(){},Picasso.View.prototype=new Picasso.core.Subject,Picasso.View.prototype._model=null,Picasso.View.prototype._modelEvents={},Picasso.View.prototype._uiActions={},Picasso.View.prototype.setModel=function(a){this._model=a;for(var b in this._modelEvents)this._modelEvents.hasOwnProperty(b)&&this._model.subscribe(b,this._modelEvents[b],this)},Picasso.View.prototype.register=function(a,b){this._modelEvents[a]=b},Picasso.View.extend=function(a){return Picasso.utils.object.extend(a,Picasso.View)};